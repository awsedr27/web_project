<?xml version="1.0" encoding="UTF-8"?>


<!DOCTYPE mapper
	PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper">


	<!-- 아이템 매퍼 -->

	<select id="getLimitItem"
		resultType="com.webpage.DAO.item.ItemDTO">
		select *from item order by itemId limit 6
	</select>

	<select id="getAjaxItem"
		resultType="com.webpage.DAO.item.ItemDTO" parameterType="int">
		select *from
		item where itemId>#{lastIdNum} order by itemId limit 6
	</select>
		
	<select id="getItemView"
		resultType="com.webpage.DAO.item.ItemDTO" parameterType="int">
		select * from item where itemId=#{itemId}
	</select>
	
	<select id="getCategoryItem"
		resultType="com.webpage.DAO.item.ItemDTO" parameterType="String">
		select *from item where category=#{category} order by itemId limit 6 
		
	</select>
	
	<select id="getCategoryAjaxItem"
		resultType="com.webpage.DAO.item.ItemDTO" parameterType="Map">
		select *from
		item where itemId>#{lastIdNum} and category=#{category} order by itemId limit 6
	</select>
	
	<!-- 회원 매퍼-->
	<select id="setMember" parameterType="com.webpage.DAO.member.MemberDTO">
	INSERT INTO homeshop.memberinfo (`memberId`, `memberPassword`, `birthday`, `phoneNum`, `email`,`houseLocation`) VALUES (#{memberId}, #{memberPassword}, #{birthday}, #{phoneNum}, #{email},#{houseLocation});
	</select>
	
	<select id="getMember"
		resultType="String" parameterType="Map">
		select memberID from memberinfo where memberId=#{memberId} and memberPassword=#{memberPassword}
	</select>
	
	<select id="getMemberInfo"
		resultType="com.webpage.DAO.member.MemberDTO" parameterType="String">
		select * from memberinfo where memberId=#{memberId}
	</select>
	
	<select id="setMyInfoModify"
		 parameterType="com.webpage.DAO.member.MemberDTO">
UPDATE homeshop.memberinfo SET `memberId` = #{memberId}, `birthday` = #{birthday}, `phoneNum` = #{phoneNum}, `email` = #{email}, `houseLocation` = #{houseLocation} WHERE (`memberId` = #{memberId});
	</select>
	
	<select id="checkPassword"
		resultType="Int" parameterType="String">
		select memberPassword from memberinfo where memberId=#{memberId}
	</select>
	
	<select id="setNewPassword"
		 parameterType="Map">
		UPDATE homeshop.memberinfo SET memberPassword = #{newPassword} WHERE (memberId = #{memberId});

	</select>
	
		<!-- 아이템뷰에 리뷰-->
    <select id="getReview"
		resultType="com.webpage.DAO.review.ReviewDTO" parameterType="int">
		select * from review where itemId=#{itemId}
	</select>
	
	<!-- 장바구니 -->
	
	<select id="getAjaxCart"
		resultType="com.webpage.DAO.cart.CartDTO" parameterType="String">
		select * from cart where memberId=#{memberId}
	</select>

	<select id="setCart"
	parameterType="com.webpage.DAO.cart.CartDTO">
	INSERT INTO homeshop.cart (`memberId`, `itemId`, `itemUrl`, `itemName`,
	`itemPrice`, `discountNum`, `discount`, `popularity`, `category`)
	VALUES (#{memberId}, #{itemId}, #{itemUrl}, #{itemName}, #{itemPrice}, #{discountNum}, #{discount},#{popularity},#{category});

    </select>
	
	<select id="deleteCart"
		 parameterType="Map">
		DELETE FROM homeshop.cart WHERE (memberId =#{memberId}) and (itemId =#{itemId});
	</select>
	
	<!-- 게시판  -->
	<select id="getBbs"
		resultType="com.webpage.DAO.bbs.BbsDTO" parameterType="Int">
		select *from bbs order by bbs_id DESC limit #{bbsNum},10
	</select>
	
	<select id="getPageCnt"
		resultType="Int">
		select count(*)from bbs
	</select>
	
	<select id="setBbs"
		 parameterType="com.webpage.DAO.bbs.BbsDTO">
		 INSERT INTO homeshop.bbs
(memberId, bbs_id, bbs_title, bbs_time, bbs_contents)
values (${memberId},(select ifnull(max(bbs_id)+1,1)from bbs as b),'${bbs_title}','${bbs_time}','${bbs_contents}');

	</select>
	
	<select id="getBbsView"
		resultType="com.webpage.DAO.bbs.BbsDTO" parameterType="Int">
		select * from bbs where bbs_id=#{bbs_id}
	</select>
	
	<select id="setBbsModify"
		 parameterType="Map">
UPDATE homeshop.bbs SET bbs_title = #{bbs_title},bbs_contents=#{bbs_contents} WHERE (bbs_id = #{bbs_id});
	</select>
	
	<select id="deleteBbs"
		 parameterType="Int">
		DELETE FROM homeshop.bbs WHERE (bbs_id = #{bbs_id});

	</select>
</mapper>